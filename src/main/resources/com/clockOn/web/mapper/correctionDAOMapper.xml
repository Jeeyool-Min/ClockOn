<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.clockOn.web.dao.CorrectionDAO"> <!-- 인터페이스명 정확하게 적어야 한다. -->

	<!-- 출퇴근 정정 테이블에 추가 -->
	<!-- List<Correction> -->
	<insert id="corrReq" parameterType="com.clockOn.web.entity.correction.Correction">
		<foreach item="cor" collection="list" separator=";">
			insert into working_corr(cor_work_day, cor_work_in, cor_work_out, cor_work_res, cor_work_req, emp_id)
			values (#{cor.cor_work_day}, '09:00:00', '18:00:00', #{cor.cor_work_res}, #{cor.cor_work_req}, #{cor.emp_id})
		</foreach>
	</insert>
	
	<!--
	정정 분류
	1. 결근- 출퇴근 생성 
	2. 퇴근누락 수정
	3. 지각 혹은 야근 시  -출퇴근 시각 수정
	 -->
	<!-- 자신의 출퇴근 정정요청 내역 보기 --> <!-- List<Correction> -->
	<select id="corrList" parameterType="String" resultType="com.clockOn.web.entity.correction.Correction">
		select work_cor_rid, cor_work_day, cor_work_in, cor_work_out, cor_work_res, cor_work_req, cor_work_state 
		from working_corr	
		where emp_id=#{emp_id} order by work_cor_rid desc 
	</select>
	
	<!-- 관리자 : 정정 신청 리스트 전체 출력 -->
	<select id="corrListAll" parameterType="String" resultType="com.clockOn.web.entity.correction.Correction">
		select work_cor_rid, cor_work_day, cor_work_in, cor_work_out, cor_work_res, cor_work_req, cor_work_state 
		from working_corr order by WORK_COR_RID desc
	</select>

	<!-- 출퇴근 테이블값 변경 -->
	<update id="corrRec" parameterType="com.clockOn.web.entity.correction.Correction">
		update working_atti
		set work_day = #{work_day}, work_in = #{work_in}, work_out = #{work_out},
			work_late = #{work_late}, holi_code = #{holi_code}, work_comm = #{work_comm}
		where work_rid = #{work_rid}
	</update>

</mapper>
