<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.clockOn.web.dao.MemberDAO"> <!-- 인터페이스명 정확하게 적어야 한다. -->

	<select id="list"
		resultType="com.clockOn.web.entity.Member">
		select * from employee order by emp_name
	</select>
	
	<select id="count" resultType="int">
		select count(emp_id) from employee
	</select>
	
	<select id="listView" resultType ="com.clockOn.web.entity.MemberList">
		select o.org_groupname, emp_dept, emp_id, emp_name, emp_posi, emp_tel, emp_email, emp_level from employee e join organization o on e.emp_dept=o.org_teamname order by o.org_groupname;	
	</select>
	
	<select id="listLeave" resultType="com.clockOn.web.entity.MemberLeave">
		select emp_dept, emp_id, emp_name, emp_posi, total_annday, annday_used, (total_annday-annday_used) as annday_rest, emp_join, emp_resi from employee order by emp_dept;	
	</select>
	
	<select id="listSal" resultType="com.clockOn.web.entity.MemberSal">
		select org_groupname, emp_dept, emp_id, emp_name, emp_posi, emp_sal, cast(floor(emp_sal/12) as char) as emp_pay, emp_join, emp_resi from employee e 
		inner join organization o on o.org_teamname = e.emp_dept;
	</select>
	<insert id="add" parameterType="com.clockOn.web.entity.Member">
		insert into employee(emp_id, emp_pw, emp_name, emp_email, emp_tel, emp_dept, emp_posi, emp_level, emp_sal, emp_pic, total_annday) 
		values(#{emp_id}, #{emp_pw}, #{emp_name}, #{emp_email}, #{emp_tel}, #{emp_dept}, #{emp_posi}, #{emp_level}, #{emp_sal}, #{emp_pic}, #{total_annday})
	</insert>
	<delete id="del" parameterType="String">
		delete from employee where id=#{emp_id}
	</delete>
	<!-- update: 관리자 - 직원정보update 직원 - password update, 직원정보 update -->
	<update id="editInfo" parameterType="com.clockOn.web.entity.Member">
		update employee 
		set 
			emp_email = #{emp_email},
			emp_pic = #{emp_pic},
			emp_pw = #{emp_pw}, 
		where emp_id = #{emp_id}
	</update>
	
	<update id="updatePw" parameterType="String">
		update employee 
		set 
			emp_pw = #{emp_pw} 
		where emp_id = #{emp_id}
	</update>
	<update id="updateInfo" parameterType="com.clockOn.web.entity.MemberList">
		update employee 
		set 
			emp_name = #{emp_name},
			emp_tel = #{emp_tel},
			emp_dept = #{emp_dept},
			emp_posi = #{emp_posi},
			emp_email = #{emp_email},
			emp_level = #{emp_level},
		where emp_id = #{emp_id}
			<!--annday_used = #{annday_used} where   혹시라도 나중에 연차 사용 취소할 경우 위해 열어둠..?? -->
	</update>
	<select id="getEmpId" resultType="String">
		select emp_id from employee;
	</select>
</mapper>